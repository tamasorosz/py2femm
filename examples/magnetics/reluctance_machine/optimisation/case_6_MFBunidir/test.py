import math

import numpy as np
import pandas as pd
import itertools

from matplotlib import pyplot as plt

# # Specify the path to your CSV file
# csv_file_path = "results/torq_res_avg.csv"
#
# # Open the file using open() and read it with pandas
# with open(csv_file_path, 'r') as file:
#     df = pd.read_csv(file)
#
# for i in range(len(df['AVG'])):
#     df.loc[i, 'AVG'] = [float(j) for j in df.loc[i, 'AVG'].split(',')]
#
# range1 = range(4, 7)
# range2 = range(7, 10)
# range3 = range(11, 14)
# range4 = range(14, 17)
#
#
# combinations = list(itertools.combinations(range(21), 4))
# lst=[]
# for x1, x2, x3, x4 in combinations:
#     result = [(a + b + c + d + e) / 5 for a, b, c, d, e in zip(df['AVG'][x1], df['AVG'][x2], df['AVG'][5], df['AVG'][x3], df['AVG'][x4])]
#
#     avg = np.average(result)
#     rip = 100 * (np.max(result) - np.min(result)) / avg
#
#
#     lst.append(rip)
# print(min(lst))
import calc_torque_avg_rip
from examples.magnetics.reluctance_machine.optimisation.case_6_MFBunidir import calc_max_torque_angle

if __name__ == '__main__':

    f = calc_max_torque_angle.max_torque_angle(0, 20, 13, 0.5, 0.5, 3, 1, 1.5, 10, 15, 4, 6)

    #     # x =[24,13,2,1,1,11,16,2,5]
    #     #
    #     # x[7] = int(x[7] * 2)
    #     # x[8] = int(x[8] * 2)
    #     #
    #     # g = (math.tan(math.radians(x[0] / 2)) * (22 - (x[4] * 0.5 + 1.5)) + x[2] + x[3]) - 8
    #     # if g > 0:
    #     #     temp_x3 = np.round(
    #     #         (8 - (math.tan(math.radians(x[0] / 2)) * (22 - (x[4] * 0.5 + 1.5))) - x[2]), 1)
    #     #     if temp_x3 < 1:
    #     #         x[3] = 1
    #     #         x[2] = int(x[2] - (1 - temp_x3))
    #     #         if x[2] < 1:
    #     #             x[2] = 1
    #     #     else:
    #     #         x[3] = temp_x3
    #     #
    #     # if x[6] + x[8] + x[0] > 43:
    #     #     x[8] = (43 - x[6] - x[0])
    #     #
    #     # if x[5] > x[6]:
    #     #     x[5] = x[6]
    #     #
    #     # if x[7] > int((x[6] - x[5])) + x[8]:
    #     #     x[7] = int((x[6] - x[5])) + x[8]
    #     #
    #     # if x[8] > int((x[6] - x[5])) + x[7]:
    #     #     x[8] = int((x[6] - x[5])) + x[7]
    #     #
    #     # print(x)
    #     #
    #     a, b = calc_max_torque_angle.max_torque_angle(30,
    #                                                     23.97,
    #                                                     13.14,
    #                                                     0.50,
    #                                                     0.32,
    #                                                     3.23,
    #                                                     1.12,
    #                                                     1.52,
    #                                                     14.85,
    #                                                     17.35,
    #                                                     2.33,
    #                                                     0.01)
    #     #
    #     # # a, b = calc_max_torque_angle.max_torque_angle(30,
    #     # #                                               19.17,
    #     # #                                               12.94,
    #     # #                                               0.58,
    #     # #                                               0.26,
    #     # #                                               2.79,
    #     # #                                               1,
    #     # #                                               1.51,
    #     # #                                               15,
    #     # #                                               17.98,
    #     # #                                               4.60,
    #     # #                                               3.78)
    #     #
    #     # print(b)
    #     # plt.plot(b)
    #     # # a, b, c, d = calc_torque_avg_rip.torque_avg_rip(30, 21, 14, 1, 0.5, 3, 1, 1.5, 12, 17, 5.5, 4)
    #     # # plt.plot(d)
    #     # # a, b, c, d = calc_torque_avg_rip.torque_avg_rip(30, 21, 14, 1, 0.5, 3, 1, 1.5, 12, 17, 8, 4)
    #     # # plt.plot(d)
    #     # # a, b, c, d = calc_torque_avg_rip.torque_avg_rip(30, 21, 14, 1, 0.5, 3, 1, 1.5, 12, 17, 6, 5)
    #     # # plt.plot(d)
    #     # # a, b, c, d = calc_torque_avg_rip.torque_avg_rip(30, 21, 14, 1, 0.5, 3, 1, 1.5, 12, 17, 5.5, 3.5)
    #     # # plt.plot(d)
    #     # plt.show()
    #
    # # 3327   21  140   1  0.5   3  2.0  1.5  12  17  4.0  1.0 -40.0 -1500.03  11.29  19.65
    # # 7226   21  140   1  0.5   3  2.0  1.5  12  17  5.5  4.0 -40.0 -1500.03  11.29  19.65
    # # 8160   21  140   1  0.5   3  2.0  1.5  12  17  8.0  4.0 -40.0 -1500.03  11.29  19.65
    # # 11637  21  140   1  0.5   3  2.0  1.5  12  17  6.0  5.0 -40.0 -1500.03  11.29  19.65
    # # 14686  21  140   1  0.5   3  2.0  1.5  12  17  4.5  3.5 -40.0 -1500.03  11.29  19.65
    #
    #     x = np.array([663.2900978597655, 730.2748829653884, 796.7576937021272, 861.8213808245092, 925.234574882194, 985.4816716451132, 1042.0562698636854, 1094.8551113360156, 1143.8847758086129, 1189.2030837856723, 1230.8044537123114, 1268.0461867329032, 1300.757258766032, 1329.873659799683, 1355.787949100826, 1378.9774729869164, 1399.9687403714645, 1419.1603743617147, 1436.8562051006547, 1453.245049703522, 1468.456655610192, 1482.667148762906, 1495.9847196187309, 1508.5173564775284, 1520.32914868082, 1531.4589096311065, 1541.9620094287036, 1551.8263005872504, 1561.0605816880457, 1569.5792497803545, 1577.322012016366, 1584.2401625195416, 1590.251002240708, 1595.2576022812832, 1599.166384709377, 1601.9240740040136, 1603.422670431946, 1603.5967574911476, 1602.181354663268, 1598.8805001951037, 1593.414164107578, 1585.4448725184066, 1574.7898064324936, 1560.7776499771128, 1543.330057608067, 1522.528659487848, 1498.0084394996895, 1469.8026815964167, 1437.5474523475232, 1401.0835435009712, 1360.454529905922, 1316.2405861140676, 1269.2209580630306, 1220.4771110801207, 1171.1622504246163, 1120.8936807867206, 1070.597216463974, 1021.2237292857995, 973.1040292887843, 927.1223675731188, 883.94736060763, 843.8226622561016, 807.1280472107588, 773.1905778374236, 741.4331118506104, 711.9759502001972, 685.077674103896, 660.3206244939016, 637.252643782186, 615.2729650746016, 594.3545171630287, 574.5748545005872, 556.1111489351645, 538.4087901193924, 521.3180620142575, 504.62303366743123, 488.17495298932204, 471.695314654496, 455.2037947405888, 438.749413113182, 422.25834075627677, 405.6193255131932, 388.86096796134444, 371.97946235153086, 354.8471924708645, 337.4196441129792, 319.78244770965864, 302.05441318970554, 284.19062956405315, 266.13316469342533, 247.93487653405535, 229.6521104749942, 211.35561844222028, 193.0147942551296, 174.6244052449978, 155.90370832325755, 137.03614161771344, 118.06452986003565, 98.94970267191155, 79.69673871167292, 60.27393235681504, 40.745303425314354, 21.011541865103826, 0.9972224221850179, -19.344164287470356, -40.10158650122684, -61.442902288032684, -83.77902596398204, -107.22667719297044, -132.18115235003825, -159.43226547339108, -188.6138467822416, -219.44805879679913, -253.07193586389704, -289.1216921588425, -327.9010547620107, -369.73321899579116, -414.9478623088728, -463.52115888646, -516.0046023803257, -572.5752761173276, -632.3700142155269, -694.4524374656876, -758.2121449102028, -822.9335407023972, -887.2766442533327, -951.9103784698084, -1015.5279626252108, -1076.4396492138708, -1133.60131326075, -1185.6488728571103, -1232.4534210569873, -1273.8722997400305, -1310.2228156688795, -1341.5378685619357, -1368.4142303579945, -1391.2694826981456, -1410.156630220464, -1424.9019307200463, -1436.001960709854, -1444.3056151185124, -1449.9018381616872, -1453.07884238002, -1454.2798322405802, -1453.7460303237858, -1451.7294573753456, -1448.4304604426263, -1443.9415126046754, -1438.4013826793137, -1431.9039864315732, -1424.5257683246243, -1416.296056712485, -1407.284614971675, -1397.5327614520686, -1387.060774627288, -1375.8945857434917, -1363.9738900190753, -1351.3336353010077, -1338.0507556087425, -1323.947080037656, -1308.9154885561068, -1292.8880823464478, -1275.7145040373064, -1257.198297297649, -1237.1471822351507, -1215.3317673904016, -1191.4123321849172, -1164.9291108752395, -1135.400259040441, -1102.438782944475, -1065.0307626748736, -1023.2339400843356, -977.9380165759256, -929.031882578764, -876.4401046100933, -820.3010227911204, -760.8475731581968, -698.5786822432792, -634.6791352382476, -569.2261720962832, -502.97007187347276, -436.84509057659085, -371.3305816674953, -306.8509204467893, -243.75873483099267, -182.38590836421093, -123.36195113251772, -67.05017356797573, -13.320523902469116, 37.28045347892121, 84.60352441903487, 128.5207222790048, 168.90017512117961, 205.92975766654482, 239.76890005291773, 270.4143293964049, 297.25048758896327, 321.30345065617286, 342.8616288551385, 362.36686100044403, 380.14110033683306, 396.10146122415074, 410.4528186631588, 423.3898367902804, 435.1724607249352, 446.03030389178, 456.0749472778208, 465.2898517206436, 473.802819120918, 481.74708959502436, 489.1264644596064, 495.87848690473044, 501.9623002048752, 507.4211300324728, 512.185913068654, 516.2596321533216, 519.6129582859616, 522.1602001551496, 523.8377870141217, 524.4645165751984, 524.0071733489508, 522.3291867531387, 519.2596197015912, 514.4633863739892, 507.67203564327, 498.92196936158115, 487.8465817814412, 474.1046579928588, 457.8747605626092, 439.1861855567268, 417.7728442496892, 393.3103299263945, 366.67090090208933, 339.00959918749976, 310.2658183066647, 281.479296544083, 250.09193577362177, 218.2455361592664, 186.6948630836777, 156.68111794778662, 129.11311719416557, 103.58511407379919, 80.56236394914684, 58.309068186223236, 35.995897489775516, 14.632733540052897, -5.870579434408908, -25.096055746601547, -42.8782889375178, -58.94925033614564, -73.28872015002852, -85.66896742965228, -96.43303491341844, -105.5071795709684, -112.77890999620892, -118.4069933044066, -122.86515571866744, -126.2185486993996, -128.7563552828783, -130.78250535522307, -132.48022935080817, -133.9055474438627, -135.05915775437504, -136.00272045976328, -136.73173327907645, -137.21017245925086, -137.51174431508684, -137.69874951272223, -137.73751568275927, -137.67798173761628, -137.5764062252295, -137.45174248077652, -137.32236053489987, -137.22225380275822, -137.15065822144427, -137.12760710830628, -137.15922902231793, -137.26136132427277, -137.45214515440335, -137.7729637804301, -138.25788240705646, -138.9389075921925, -139.95436888699535, -141.44534789730264, -143.5125435024071, -146.30224834957704, -149.9622925859314, -154.53095810650564, -160.0635886950477, -166.4889602688475, -173.78781028476817, -182.28374433886097, -191.96127687055835, -202.81058151387643, -214.49953518617775, -226.6528308578172, -239.20113211364443, -251.50227097923795, -263.0560185794368, -273.93246624567564, -284.2521265077568, -295.4340400588779, -307.1498759118679, -320.7105885596958, -337.0721326551515, -356.4778282884066, -375.7550265974444, -393.6414844213769, -410.5756038278996, -426.8619455424228, -441.49873970374443, -454.1634883784476, -464.7195110732592, -472.6531083966336, -478.4179283350772, -482.1148127059388, -483.93982046749403, -484.0282030110948, -482.5042126614008, -479.7910326167496, -476.1688447210684, -471.73056528362963, -466.3572527282132, -460.0796040700508, -453.0547230601184, -445.319485794296, -436.8345066460324, -427.6777565468256, -417.91386580857284, -407.5576062322024, -396.663166662105, -385.2297759585176, -373.2133542650873, -360.66692617122595, -347.49543879772256, -333.5598381129428, -318.7498376554843, -302.94532358204117, -286.1901240709025, -268.26293033557755, -248.93318647293287, -228.2081432805701, -205.69020581161269, -181.0384532319965, -154.07782267012306, -124.46819488574452, -91.34552860296188, -55.361999154348844, -16.552666062482732, 25.3916522231482, 70.4693416499682, 118.60495133794612, 169.5231815190262, 223.74077569022134, 281.3244938291032, 341.3816051546048, 403.27514544246765, 466.579412425416, 531.1594945876916, 596.7951976326624, 663.2900978597607])
    #     y = np.array([10.87479691907656, 69.59969888883596, 127.97460981859842, 185.70840421854473, 242.23908361163657, 296.8416633659879, 349.7041224464596, 400.31948113606717, 448.09949408414565, 493.0296370247036, 535.0465463396824, 573.8593633557012, 609.6196477569467, 642.4081034952463, 671.3781987941964, 697.1902375103905, 720.3195561417568, 741.1899075829036, 760.2375744215816, 777.8045989471372, 794.0942983504273, 809.2903498833103, 823.5186112812615, 836.8312615295252, 849.2896983538756, 860.9614080408804, 871.954302319404, 882.2636633676228, 891.919405011918, 900.9472415750353, 909.3195471166551, 916.9915744737388, 923.9101342958844, 930.0561637962752, 935.412471169122, 939.96814831802, 943.75842989696, 946.6088316949985, 948.423621158734, 949.0102205492001, 948.2416231254392, 945.8307408555272, 941.4011164309424, 934.7461219640431, 925.6760287286364, 913.895315528866, 899.4496386678957, 881.8355270748076, 861.0565201535209, 836.9057511720612, 809.3468368502143, 778.6634563425644, 745.723907289108, 710.768825350618, 674.1323919403976, 636.505298160808, 596.5020826266972, 555.9152298171575, 515.244294755752, 475.2102285205824, 436.5965929591348, 399.6596376332078, 364.6414005116553, 331.5165724580886, 300.20502209205256, 270.7011114121015, 242.99307328481729, 217.63234475461613, 194.55437614443355, 173.491168035897, 154.4109182808672, 137.4088519376696, 122.2915337295672, 108.8490629713924, 97.17847884943272, 86.9655689662396, 77.97867444071224, 69.91692197507356, 62.564768154404526, 55.82902231833568, 49.514079952690764, 43.504401283250964, 37.7737216840366, 32.27474640022278, 26.983923978100524, 21.887442118721864, 16.897719095462755, 11.978301576810193, 7.123393632189676, 2.3107889887020843, -2.4721035275283683, -7.25043554162904, -12.056393808275985, -16.91647602308878, -21.85555162937633, -26.872380578875163, -31.96592928686974, -37.17124119885586, -42.572736740111246, -48.1817741342816, -54.065254527744045, -60.25404445769324, -66.85881554729103, -74.00211796796044, -81.81869391097256, -90.5290707430106, -100.31954523212244, -111.40356573038204, -124.35443714368652, -139.1463259535949, -155.76218299851226, -174.29658862353108, -194.925953860397, -217.32577309705468, -241.73897935107806, -268.29569993708105, -296.7095024506957, -327.02748961022724, -359.0066609300572, -392.77613786407653, -428.4334046337724, -465.8515152542552, -504.5056693794376, -543.7401648668451, -583.0681725004539, -621.8174555209864, -658.3778154881904, -694.1382949280847, -728.46801532909, -760.8936545997976, -791.2989577753689, -818.3811130073436, -842.04529081193, -862.35196766991, -879.5655164679939, -893.8759442331063, -905.5115478900968, -914.3231701834584, -920.4721399432309, -924.4791216511336, -926.6788204483112, -927.3847855038304, -926.800876906662, -925.0797987489365, -922.2667101687864, -918.445696392132, -913.7248121236636, -908.1671970455204, -901.813947875534, -894.7511774767464, -887.0246006924503, -878.6441863116839, -869.6134821027993, -859.9771430789148, -849.7158888738237, -838.7896109584689, -827.1143215861629, -814.6513942126201, -801.3139255232355, -787.0347562425344, -771.8038668873925, -755.5104050601859, -737.9776798431972, -718.9861548956928, -698.1664337054344, -675.1213538741164, -649.3535032208532, -620.4096906599324, -587.6697667018088, -552.0067078953416, -513.2609216884636, -471.236054391574, -426.31822092824723, -378.50490667556335, -327.85027822382295, -275.09813757331267, -220.56979752398794, -164.03489448659568, -106.2928086894582, -47.86660300932464, 10.874796919034207, 69.59969888898884, 127.97460981865407, 185.70840421855692, 242.23908361160596, 296.8416633681547, 349.7041224462593, 400.31948113626356, 448.099494083884, 493.02963702469435, 535.0465463396205, 573.8593633557548, 609.6196477569707, 642.408103495404, 671.3781987941832, 697.1902375104396, 720.3195561417905, 741.189907582934, 760.2375744215968, 777.8045989472035, 794.0942983504152, 809.2903498832771, 823.5186112813044, 836.8312615295453, 849.2896983538288, 860.961408040912, 871.9543023193768, 882.2636633676376, 891.9194050119904, 900.9472415750492, 909.319547116642, 916.991574473732, 923.9101342959192, 930.0561637962348, 935.4124711689648, 939.9681483179384, 943.7584298969189, 946.6088316949548, 948.4236211586792, 949.010220549178, 948.241623125456, 945.8307408554376, 941.4011164309992, 934.7461219641507, 925.6760287287036, 913.8953155285596, 899.4496386678472, 881.8355270755388, 861.0565201536003, 836.9057511720421, 809.3468368486424, 778.6634563426544, 745.7239072891856, 710.7688253503744, 674.1323919404132, 636.50529816083, 596.5020826266996, 555.915229817146, 515.244294755734, 475.21022852057797, 436.5965929591124, 399.6596376332035, 364.6414005115019, 331.51657245805774, 300.20502209201743, 270.7011114120997, 242.99307328481936, 217.6323447546822, 194.55437614481812, 173.49116803594154, 154.41091828080596, 137.40885193771112, 122.29153372950728, 108.84906297136617, 97.17847884943824, 86.96556896629164, 77.9786744407144, 69.91692197508856, 62.56476815432864, 55.8290223183638, 49.514079952644956, 43.5044012832604, 37.77372168408157, 32.274746400473134, 26.983923978115463, 21.887442118529318, 16.897719095437218, 11.978301576802252, 7.123393632188088, 2.310788988703533, -2.472103527503777, -7.250435541626084, -12.056393808309256, -16.916476023093832, -21.855551630438242, -26.872380578872324, -31.9659292869039, -37.17124119887769, -42.57273674019076, -48.181774134305435, -54.06525452782048, -60.25404445771904, -66.85881554726843, -74.00211796795813, -81.81869391096508, -90.52907074302036, -100.31954523214, -111.40356573035184, -124.35443714372096, -139.14632595358557, -155.762182998706, -174.29658862354844, -194.92595386211454, -217.32577309741862, -241.73897935197732, -268.2956999371185, -296.70950245066484, -327.027489610252, -359.0066609300765, -392.7761378640263, -428.4334046338572, -465.8515152542572, -504.50566937941244, -543.740164866634, -583.0681725003852, -621.817455520974, -658.3778154877792, -694.1382949281492, -728.4680153291112, -760.8936546009936, -791.2989577752896, -818.3811130072676, -842.0452908177905, -862.3519676698777, -879.5655164702708, -893.8759442331252, -905.5115478901205, -914.3231701834504, -920.4721399432087, -924.4791216511647, -926.678820448402, -927.3847855038975, -926.8008769065904, -925.07979874898, -922.266710168838, -918.4456963921288, -913.724812123686, -908.1671970455511, -901.813947875532, -894.7511774767701, -887.0246006924036, -878.6441863114944, -869.61348210276, -859.977143078948, -849.7158888738333, -838.7896109584316, -827.1143215861596, -814.6513942126528, -801.3139255232936, -787.0347562426297, -771.8038668873916, -755.5104050601473, -737.9776798431504, -718.9861548955963, -698.1664337054624, -675.1213538740795, -649.3535032208648, -620.4096906599208, -587.6697667018055, -552.0067078950752, -513.2609216889348, -471.23605439159485, -426.3182209285464, -378.5049066756053, -327.8502782240887, -275.09813757342897, -220.5697975238435, -164.03489448611592, -106.29280868944836, -47.86660300939028, 10.874796919110123])
    #     z = x-y
    #     print(np.average(y))
    #     print(np.average(z))
    #     plt.plot(x)
    #     plt.plot(y)
    #     plt.plot(z)
    #     plt.show()